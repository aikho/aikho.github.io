<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Увеличение скорости машинного обучения | AIkho.github.io</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Увеличение скорости машинного обучения" />
<meta name="author" content="Андрей Хобня" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Большинство последних улучшений и прорывов в машинном обучении происходило в основном в области создания моделей, которые обучаются лучше, чем их предшественники. При этом, чем точнее модель, тем, как правило, выше ее вычислительная сложность. Конечно, доступные вычислительные мощности растут, железо совершенствуется, развиваются оптимизированные под глубокое обучение библиотеки. Тем не менее, работа с наиболее передовыми моделями машинного обучения требует все большего количества ресурсов. Поэтому нам нужны не только более точные модели, но и более эффективные алгоритмы обучения. Какие исследования в данном направлении сейчас ведутся и что уже сделано?" />
<meta property="og:description" content="Большинство последних улучшений и прорывов в машинном обучении происходило в основном в области создания моделей, которые обучаются лучше, чем их предшественники. При этом, чем точнее модель, тем, как правило, выше ее вычислительная сложность. Конечно, доступные вычислительные мощности растут, железо совершенствуется, развиваются оптимизированные под глубокое обучение библиотеки. Тем не менее, работа с наиболее передовыми моделями машинного обучения требует все большего количества ресурсов. Поэтому нам нужны не только более точные модели, но и более эффективные алгоритмы обучения. Какие исследования в данном направлении сейчас ведутся и что уже сделано?" />
<link rel="canonical" href="https://aikho.github.io/2018/04/24/machine-learning-training-performance.html" />
<meta property="og:url" content="https://aikho.github.io/2018/04/24/machine-learning-training-performance.html" />
<meta property="og:site_name" content="AIkho.github.io" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-04-24T23:10:00+03:00" />
<script type="application/ld+json">
{"description":"Большинство последних улучшений и прорывов в машинном обучении происходило в основном в области создания моделей, которые обучаются лучше, чем их предшественники. При этом, чем точнее модель, тем, как правило, выше ее вычислительная сложность. Конечно, доступные вычислительные мощности растут, железо совершенствуется, развиваются оптимизированные под глубокое обучение библиотеки. Тем не менее, работа с наиболее передовыми моделями машинного обучения требует все большего количества ресурсов. Поэтому нам нужны не только более точные модели, но и более эффективные алгоритмы обучения. Какие исследования в данном направлении сейчас ведутся и что уже сделано?","author":{"@type":"Person","name":"Андрей Хобня"},"@type":"BlogPosting","url":"https://aikho.github.io/2018/04/24/machine-learning-training-performance.html","headline":"Увеличение скорости машинного обучения","dateModified":"2018-04-24T23:10:00+03:00","datePublished":"2018-04-24T23:10:00+03:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://aikho.github.io/2018/04/24/machine-learning-training-performance.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://aikho.github.io/feed.xml" title="AIkho.github.io" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">AIkho.github.io</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/rules/">Правила</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Увеличение скорости машинного обучения</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2018-04-24T23:10:00+03:00" itemprop="datePublished">Apr 24, 2018
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Большинство последних улучшений и прорывов в машинном обучении происходило в основном в области создания моделей, которые обучаются лучше, чем их предшественники.
При этом, чем точнее модель, тем, как правило, выше ее вычислительная сложность.
Конечно, доступные вычислительные мощности растут, железо совершенствуется, развиваются оптимизированные под глубокое обучение библиотеки. Тем не менее,
работа с наиболее передовыми моделями машинного обучения требует все большего количества ресурсов. Поэтому нам нужны не только более точные модели,
но и более эффективные алгоритмы обучения.
Какие исследования в данном направлении сейчас ведутся и что уже сделано?</p>

<p>Для удобства и систематизации я условно разделяю все способы ускорения обучения на три большие группы:</p>

<ol>
  <li><strong>Улучшение алгоритмов оптимизации</strong>. К этой группе способов относится применение адаптивных алгоритмов обучения, различных вариаций стохастического градиентного спуска,
применение различных вариантов динамического изменения параметров оптимизатора и т.д.</li>
  <li><strong>Улучшение самих моделей машинного обучения</strong>. Некоторые модели обучаются не только лучше, но и быстрее других моделей.</li>
  <li><strong>Оптимизация <em>применения</em> алгоритмов оптимизации</strong>. Сюда относятся различные вариации применения алгоритмов оптимизации к модели: последовательное обучение различных частей модели,
применение нескольких алгоритмов оптимизации, инициализация параметров модели до применения оптимизации и т.д.</li>
</ol>

<p>Рассмотрим работы в каждом из направлений.</p>

<h3 id="Улучшение-алгоритмов-оптимизации">Улучшение алгоритмов оптимизации</h3>

<p>Исследования 2016-2018 годов в данной области рассматривают в основном способы улучшения алгоритма стохастического градиентного спуска и адаптивных алгоритмов.</p>

<p>Например, предложен метод нормализованного градиента с адаптивным размером шага [<a href="#r1">1</a>]. Метод включает в себя применение двух последовательных шагов: вычисление и нормализация градиента
и выбор адаптивного шага для обновления параметров. Этот метод может применятся к алгоритму стохастического градиентного спуска, алгоритму ADAM, AdaGrad и другим.
Авторы провели несколько экспериментов, включая обучение перцептрона, сверточной и рекурентной нейронной сети, и выяснили, что данный метод может значительно ускорять
оптимизацию глубоких нейронных сетей от 18 слоев или рекурентных сетей развернутых от 40 до 1000 шагов.</p>

<p>Предложен алгоритм неустойчивого стохастического градиентного спуска (Inconsistent Stochastic Gradient Descent – ISGD) [<a href="#r2">2</a>]. Основная идея алгоритма – различное отношение к различным батчам
данных. Когда алгоритм идентифицирует, что модель недообучена для текущего батча данных, тогда размер шага обучения увеличивается, но при этом добавляется дополнительное ограничение,
которое позволяет избежать радикального изменения текущих весов модели. Эксперименты показывают, что ISGD сходится быстрее, чем классический SGD.
Например, при обучении нейронной сети AlexNet, ISGD на 21,05% быстрее чем SGD при достижении точности в 56%.</p>

<p>Предложено использовать стохастический градиентный спуск с предварительным условием (Preconditioned Stochastic Gradient Descent), который использует особый вид предобуславлевателя (preconditioner) [<a href="#r3">3</a>].
В некоторых случаях это позволяет обучить модель примерно в два раза быстрее.</p>

<p>Предложен алгоритм разреженного обратного распространения ошибки (Sparsified Back Propagation) [<a href="#r4">4</a>]. Суть алгоритма в том, что при обратном распространении ошибки
вычисляется только небольшое подмножество элементов полного градиента для обновления параметров модели.
Эксперименты авторов показывают, что можно обновлять только 1-4% от всех весов модели за каждую итерацию и при этом получить даже более высокую точность!
Это и не удивительно. Применение таких техник, как pruning, показывает, что можно удалить до 90% весов обученной нейронной сети и потерять лишь процентик точности.
Так зачем мы тратим ресурсы на вычисление градиента для такого огромного количества бесполезных в результате весов?</p>

<h3 id="Улучшение-моделей-машинного-обучения">Улучшение моделей машинного обучения</h3>

<p>В этой области не так много исследований. Не исключено, что я недостаточно качественно искал.</p>

<p>Как правило, чем проще модель, тем быстрее она обучается и тем менее точно решает задачу. Однако, существуют техники, которые способны ускорить обучения без потери точности.
Одним из самых известных примеров является batch normalization [<a href="#r5">5</a>]. Эта техника предложена в 2015 году и применена в нейронной сети Inception.
Суть техники заключается в применении нормализации к входным значениям различных слоев/блоков нейронной сети.
Применение этой техники позволяет Inception обучаться на данных ImageNet в 14 раз быстрее.</p>

<h3 id="Оптимизация-применения-алгоритмов-оптимизации">Оптимизация применения алгоритмов оптимизации</h3>

<p>В этом направлении очень широкое поле для творчества.
Из предложенных в 2017 году и уже применяемых на практике техник, самые известные – Snapshot Ensembles и FreezeOut.</p>

<p>Подход Snapshot Ensembles [<a href="#r6">6</a>] позволяет за один цикл обучения вместо одной модели получить целый ансамбль моделей.
Использование ансамблей – это популярная техника увеличения точности. Обычно она требует больших вычислительных ресурсов для обучения нескольких вариантов модели.
Snapshot Ensembles делает снэпшоты модели в различных локальных минимумах на протяжении одного цикла обучения.
Авторы опираются на то, что в различных локальных минимумах модель совершает, как правило, различные ошибки.
Таким образом, если агрегировать результаты моделей из различных локальных минимумов, можно получить лучшую итоговую точность.</p>

<p>Метод FreezeOut позволяет увеличить скорость обучения путем последовательного “замораживания” весов сети по слоям [<a href="#r7">7</a>] .
Авторы экспериментировали с последовательными заморозками слоев сети и показали, что это позволяет увеличить скорость обучения без потери точности.
Этот подход довольно быстро можно реализовать самостоятельно на любом фреймворке глубокого обучения.</p>

<h3 id="Заключение">Заключение</h3>

<p>В целом, существующие исследования в области ускорения обучения моделей выглядят многообещающе.
Некоторые методы можно использовать уже сейчас. А что применяете вы для ускорения обучения своих нейронных сетей?</p>

<p>Ссылки:</p>
<ol>
  <li><a name="r1"></a> <a href="https://arxiv.org/abs/1707.04822v1">Normalized Gradient with Adaptive Stepsize Method for Deep Neural Network Training (arXiv:1707.04822)</a></li>
  <li><a name="r2"></a> <a href="https://arxiv.org/abs/1603.05544v3">Accelerating Deep Neural Network Training with Inconsistent Stochastic Gradient Descent (arXiv:1603.05544)</a></li>
  <li><a name="r3"></a> <a href="https://arxiv.org/abs/1512.04202v3">Preconditioned Stochastic Gradient Descent (arXiv:1512.04202)</a></li>
  <li><a name="r4"></a> <a href="http://proceedings.mlr.press/v70/sun17c.html">meProp: Sparsified Back Propagation for Accelerated Deep Learning with Reduced Overfitting</a></li>
  <li><a name="r5"></a> <a href="https://arxiv.org/abs/1502.03167">Batch Normalization: Accelerating Deep Network Training by Reducing Internal Covariate Shift (arXiv:1502.03167)</a></li>
  <li><a name="r6"></a> <a href="https://arxiv.org/abs/1704.00109">Snapshot Ensembles: Train 1, get M for free (arXiv:1704.00109)</a></li>
  <li><a name="r7"></a> <a href="https://arxiv.org/abs/1706.04983">FreezeOut: Accelerate Training by Progressively Freezing Layers (arXiv:1706.04983)</a></li>
</ol>

  </div><div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'https://aikho.github.io/2018/04/24/machine-learning-training-performance.html';
      this.page.identifier = 'https://aikho.github.io/2018/04/24/machine-learning-training-performance.html';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://andrei-khobnia-blog.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><a class="u-url" href="/2018/04/24/machine-learning-training-performance.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">AIkho.github.io</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Андрей Хобня</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/aikho"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">aikho</span></a></li><li><a href="https://kaggle.com/khandd"><svg class="svg-icon"><use xlink:href="/assets/kaggle.svg#kaggle"></use></svg> <span class="username">khandd</span></a></li><li><a href="https://www.twitter.com/AI_Kho_"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">AI_Kho_</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Блог о машинном обучении и разработке интеллектуальных систем</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
